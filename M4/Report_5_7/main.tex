%!TEX TS-program = xelatex

% Шаблон документа LaTeX создан в 2018 году
% Алексеем Подчезерцевым
% В качестве исходных использованы шаблоны
%     Данилом Фёдоровых (danil@fedorovykh.ru)
%        https://www.writelatex.com/coursera/latex/5.2.2
%    LaTeX-шаблон для русской кандидатской диссертации и её автореферата.
%        https://github.com/AndreyAkinshin/Russian-Phd-LaTeX-Dissertation-Template

\documentclass[a4paper,14pt]{article}

\input{data/preambular.tex}
\begin{document} % конец преамбулы, начало документа
\input{data/title.tex}
\tableofcontents
\pagebreak

\section{ЦЕЛИ РАБОТЫ}
Целями данной работы являются:

\begin{itemize}
    \item получение навыков получения, обработки и представления результатов многократных измерений;
    \item формирование базовых навыков работы в среде NI LabVIEW по раз-работке компонентов для автоматизированной обработки результатов однократных измерений.
\end{itemize}

\section{ПРИМЕНЯЕМОЕ ОБОРУДОВАНИЕ И ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ}

\begin{enumerate}
    \item    Персональный компьютер (ПК).
    \item    Плата сбора данных NI-DAQ M-series PCI-6221/6251.
    \item    Кабель NI SH68-68-EPM Shielded Cable.
    \item    Коннекторный блок NI BNC 2120
    \item    Провод соединительный коаксиальный (BNC-BNC).
    \item    Среда разработки NI LabVIEW 2013 Professional.
\end{enumerate}


\section{СТРУКТУРА ПРИКЛАДНОГО     ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ}
\subsection{Виртуальный прибор сбора и визуализации данных}

Прибор, изображенный на Рис. \ref{img:av_vi} позволяет измерять напряжение на некотором элемента.
В качестве источника используется блок DAQ Assistant (Рис. \ref{img:av_schema}).

С помощью панели управления можно задать задержку между соседними снятиями сигналов, а так же остановить вычисления.
Снятые значения выводятся на диаграмму в виде точек.
Кроме того, выполняется обработка данных и усреднение результатов за последние 4 измерения, что сглаживает распределение величин.

В конечном счёте пользователь получает два графика -- текущее значение, которое отмечено точками, и усредненное в процессе измерения, обозначенное красной линией.

\begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{image/av_vi}
    \caption{Передняя панель Acquire Voltage}\label{img:av_vi}
\end{figure}


\begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{image/av_schema}
    \caption{Блок-схема Acquire Voltage}\label{img:av_schema}
\end{figure}

\subsection{Виртуальный прибор выполнения многократных измерений }

Передняя панель (Рис. \ref{img:vmm_vi})  по сравнению с предыдущей (Рис. \ref{img:av_vi}) претерпела изменения.
Был отключен вывод усредненного значения на тот же график, добавлен вывод метрик на панель, а именно минимального и максимального значения и среднего.
Кроме того, появилась возможность задавать количество сборов данных через числовое средство ввода <<Number of samples>>.
Добавлен график вывода усредненной информации измерений, при чем усреднение происходит автоматически на каждом участке продолжительностью 0,25 с.
Для удобства дальнейшего редактирования добавлена возможность сохранять полученные данные в файл с помощью элемента выбора файла и индикатора <<Write report>>.
Кроме того, часть измерений выводится напрямую на экран в элемент <<Voltage array>>.

\begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{image/vmm_vi}
    \caption{Передняя панель Voltage Multiple Measurements}\label{img:vmm_vi}
\end{figure}

Под капотом данной VI находится блок схема, представленная на Рис. \ref{img:vmm_schema}.
Количество измерений передается в цикл обработки, далее данные считываются несколько раз с задержкой 250 мс и выводятся на график.
После полученный массив обрабатывается на поиск среднего, минимального и максимального значения, выводится на VI, строимся сгруппированный график с шагом 0,25 с и началом отсчёта в 0 с.
Кроме того, если был выбран пункт сохранения в файл, производится запись с точностью до 5 знаков после запятой.

\begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{image/vmm_schema}
    \caption{Блок-схема Voltage Multiple Measurements}\label{img:vmm_schema}
\end{figure}

\subsection{ПРОВЕРКА РЕЗУЛЬТАТОВ ИЗМЕРЕНИЙ НА НАЛИЧИЕ ПРОМАХОВ ПО КРИТЕРИЮ ГРАББСА}

Данная VI (Рис. \ref{img:ot_vi}))предназначена для обработки данных из файла.
С помощью диалогового окна выбирается датасет с результатами некоторых измерений, устанавливается необходимый уровень значимости, который используется при вычислении по критерию Граббса, а так же устанавливается тип сравнения -- критерий Граббса или $3\sigma$.
После выполнения расчетов на верхний график подается изображение исходной выборки, а на нижний -- хороших результатов, прошедших проверку.
Кроме того, в поле <<Array>> попадают значения, отфильтрованные критерием; заполняются поля среднего значения и СКО.

\begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{image/ot_vi}
    \caption{Передняя панель Outlier test}\label{img:ot_vi}
\end{figure}

На рис. \ref{img:ot_schema} представлена блок-схема соответствующей VI.
В данном примере представлен шаг проверки на промахи по критерию $3\sigma$ при отсутствии ошибок.
На рис. \ref{img:ot_schema_init}, \ref{img:ot_schema_err}, \ref{img:ot_schema_stop} представлены шаги инициализации, вычислении ошибок и остановки и являются простыми.
На рис. \ref{img:ot_schema_grubbs} представлен расчет критерия Граббса.
На рис. \ref{img:ot_schema_remove} представлена операция по очистке выборки от промахов.

Обработка данных происходит следующим образом: данные загружаются из файла и выводятся на plot <<Исходная выборка>>.
Далее для данных вычисляется среднее и СКО, затем происходит нормировка и, если все значения удовлетворяют некоторому критерию, выводятся на plot <<Обработанные результаты>>.
Если же есть выбросы, данные обрабатываются еще раз с шага вычисления метрик.
Так происходит до тех пор, пока не будут удовлетворять критерию все данные, после чего вычисления прекращаются.

\begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{image/ot_schema}
    \caption{Блок-схема Outlier test}\label{img:ot_schema}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\linewidth]{image/ot_schema_init}
    \caption{Блок-схема Outlier test. Инициализация}\label{img:ot_schema_init}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\linewidth]{image/ot_schema_err}
    \caption{Блок-схема Outlier test. Расчет ошибки}\label{img:ot_schema_err}
\end{figure}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\linewidth]{image/ot_schema_stop}
    \caption{Блок-схема Outlier test. Остановка}\label{img:ot_schema_stop}
\end{figure}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.3\linewidth]{image/ot_schema_grubbs}
    \caption{Блок-схема Outlier test. Проверка по критерию Граббса}\label{img:ot_schema_grubbs}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.3\linewidth]{image/ot_schema_remove}
    \caption{Блок-схема Outlier test. Очистка выборки}\label{img:ot_schema_remove}
\end{figure}

\subsection{ПОЛУЧЕНИЕ, ОБРАБОТКА И ПРЕДСТАВЛЕНИЕ РЕЗУЛЬТАТОВ ПРЯМЫХ МНОГОКРАТНЫХ ИЗМЕРЕНИЙ}

Данная VI (Рис. \ref{img:mp_vi}) позволяет производить анализ множественных измерений.
Исходные данные извлекаются из файла, затем с помощью кнопок управления совершаются соответствующие действия.
Для контроля обработки вручную задаются доверительный интервал и границы неисключенной систематической погрешности.
Итоговый результат записывается в таблицу <<Результат измерений>>, а так же выводится в соответствующее поле с учетом погрешности и строки форматирования.

\begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{image/mp_vi}
    \caption{Передняя панель multiple measurements}\label{img:mp_vi}
\end{figure}

На блок-схеме изображен процесс обработки данных (Рис. \ref{img:mp_schema}).
Сначала данные считываются из файла  (Рис. \ref{img:mp_schema_scan}), затем передаются на стадию вычисления оценок.
На этой стадии рассчитываются среднее, СКО,  ошибку  (Рис. \ref{img:mp_schema_calc_score}), записываются в структуру и передаются далее.
После вычисляется доверительный интервал по критерию Стьюдента с учетом уровня значимости и полученных ранее величин (Рис. \ref{img:mp_schema_calc_D}), данные записываются и передаются далее.
На последнем этапе информация форматируется с использованием строки форматирования и выводится на экран результат измерения с учетом погрешности  (Рис. \ref{img:mp_schema_write}).

\begin{figure}[H]
     \centering
     \includegraphics[width=\linewidth]{image/mp_schema}
    \caption{Блок-схема multiple measurements}\label{img:mp_schema}
\end{figure}

  \begin{figure}[H]
     \centering
     \includegraphics[width=0.7\linewidth]{image/mp_schema_0}
     \caption{Блок-схема multiple measurements. Получение данных}\label{img:mp_schema_scan}
 \end{figure}

 \begin{figure}[H]
    \centering
    \includegraphics[width=0.7\linewidth]{image/mp_schema_1}
    \caption{Блок-схема multiple measurements. Вычисление оценки}\label{img:mp_schema_calc_score}
\end{figure}
 \begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{image/mp_schema_2}
    \caption{Блок-схема multiple measurements. Вычисление доверительного интервала}\label{img:mp_schema_calc_D}
\end{figure}
 \begin{figure}[H]
    \centering
    \includegraphics[width=0.7\linewidth]{image/mp_schema_3}
    \caption{Блок-схема multiple measurements. Запись результата}\label{img:mp_schema_write}
\end{figure}
\section{ПОРЯДОК ВЫПОЛНЕНИЯ РАБОТЫ}
\begin{enumerate}
\item     Построение ВП для сбора и визуализации данных на основе Express-VI DAQ Assistant.
 Выполнение сбора и визуализации данных.
 Исследование режимов отображения данных на диаграмме Waveform Chart.
 Экспорт измеренных значений (таблица 1).
\item     Построение ВП для выполнения и сохранения результатов многократных измерений.
 Выполнение многократных измерений, сохранение полученных результатов (таблица 2).
\item     Построение ВП для проверки результатов измерений на наличие промахов.
Проверка тестовой выборки (таблица 3.1), проверка результатов измерений (таблица  3.2).
\item     Построение ВП для обработки результатов многократных измерений.
Обработка тестовой выборки (таблица 4.1), результатов измерений (таблица 4.2).
\end{enumerate}

\section{ РЕЗУЛЬТАТЫ ИЗМЕРЕНИЙ И ВЫЧИСЛЕНИЙ}

\subsection{Результаты сбора данных}
Таблица и график с результатами измерений, полученные с помощью Acquire Voltage.vi (ЛР 5).
Таблица 1
\subsection{Результаты многократных измерений}

Таблица с результатами измерений, полученных с помощью Voltage Multiple Measurements.vi (ЛР 6). Также записать максимальное, минимальное и среднее значения.
Таблица 2
\subsection{Результаты проверки на промахи по критерию Граббса}

\section{ВЫВОДЫ ПО РАБОТЕ}
\end{document} % конец документа